# Cyrrency converter (конвертер валют)
Сервис конвертации валют, обладающий возможностью обновления базы курсов валют "на лету" в двух режимах: полная замена данных, объединение данных.

## API
Конвертация валют:
- **GET** /convert?from=RUB&to=USD&amount=42
Где:
	- **from**=CHAR_CODE - валюта из которой необходимо провести конвертацию
	- **to**=CHAR_CODE - валюта в которую необходимо конвертировать
	- **amount**=NUMBER - количество денежных единиц подвергаемых конвертации

Обновление данных курса валют:
- **POST** /database?merge=1
Где:
	- **merge**=NUMBER - режим добавления даных: 0 - замена, 1 - объединение
	- **request body** - json вида {"CHAR_CODE": NUMBER} 
	Пример:
```json
 {
    "USD": 73.6376,
    "EUR": 87.1722,
    "BGN": 44.5425
}
```

## Ответ от API
Ответы от API приходят в виде JSON.
- **GET convert**
```json
{
  		"from": "USD",
  		"to": "EUR",
  		"amount": 1.0,
  		"converted_amount": 0.8447
}
```
Где:
	- **from** - валюта из которой необходимо проведена конвертация
	- **to** - валюта в которую проведена конвертация
	- **amount** - количество конвертируемых денежных единиц
	- **converted_amount** - сконвертрованное количество денежных единиц

- **POST merge**
```json
{
  		"result": true
}
```
Где:
	- **result** - результат операции добавления данных. Всегда возвращается "True". В случае проблем добавления данных, в ответе от метода приходит результат с ошибкой (см. далее раздел Ошибки)

## Ошибки
В случае ошибок работы севиса возвращается код ответа 200 и json описание ошибки
```json
{
		"error_code": 0,
		"detail_msg": "Внутренняя ошибка сервиса" 
}
```
Где:
- **error_code** - код ошибки
- **detail_msg** - описание ошибки

## Коды ошибок
- **0** - ошибка в работе сервиса
- **1** - ошибка конвертации

## Зависимости
- aioredis
- aiohttp
- для работы сервиса необходим сервер Redis

## Быстрый запуск
Быстрый запуск сервиса состоит из следующих шагов:
1. Установить сервер Redis
```
$ apt-get update
$ apt-get install redis
```
1. Установить зависимости
```
$ python3 -m pip install -r requirements.txt
```
1. Выполнить скрипт запуска сервиса
```
$ cd ./service/
$ /bin/bash run_service.sh
```

## Настройка
Сервис настраивается с помощью файла конфигурации "configuration.ini". Ниже будут рассмотрены основные параметры файла конфигурации.
- Настройка базовой валюты. Определяет относительно какой валюты будет происходить конвертация и трактование данных о курсах валют, добавляемых и считываемых из базы данных.
```
[CONVERTER]
BaseCurrency = RUB
```
- Настройка адреса сервера Redis к которому подключается сервис конвертации.
```
[REDIS]
Host = localhost
```
- Настройка порта сервера Redis к которому подключается сервис конвертации.
```
[REDIS]
Port = 6379
```
